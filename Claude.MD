# CLAUDE.md â€“ Development Standards & AI Collaboration Guide

This project uses:
- TypeScript + Vite
- Tailwind CSS
- Netlify (frontend hosting)
- Netlify Functions for backend
- Supabase (auth + database)
- Claude Code for AI collaboration

UI/UX is our highest priority. Everything we build should feel fast, elegant, and intentional.

---

## ğŸš§ CRITICAL WORKFLOW

ğŸ§­ We always follow this sequence:

**Research â†’ Plan â†’ Implement**

> Claude must always say:  
> â€œLet me research the codebase and create a plan before implementing.â€

â— Claude may not generate or change code until the plan is reviewed and approved.

---

## âœ… AUTOMATED CHECKS ARE MANDATORY

All pre-commit hooks are enforced. Everything must be âœ… GREEN.

- âŒ Hook failures are BLOCKING â€“ stop immediately
- ğŸ”§ Fix formatting issues: `make fmt`
- ğŸ§ª Fix test failures: `make test`
- ğŸ” Fix linting issues: `make lint`
- ğŸ›‘ Never skip or ignore errors
- ğŸ’¯ Your code is complete when:
  - All tests pass
  - All linters pass
  - Feature works end-to-end
  - No unused/legacy code remains

---

## ğŸ“ Project Structure

```
src/
  components/     â†’ Reusable React components (UI-first)
  pages/          â†’ Next.js-style page routing
  styles/         â†’ Tailwind utilities and design tokens
  api/            â†’ API routes (via Netlify Functions)
  utils/          â†’ Client-side helpers
netlify/functions/ â†’ Serverless backend logic (TS)
supabase/         â†’ Edge functions, SQL, policies
public/           â†’ Static assets
```

ğŸ§  Claude must infer structure and reuse patterns across files.
Never invent folder layoutsâ€”reuse existing organization.

---

## ğŸ¨ UI/UX RULES (Top Priority)

- All new UIs must be pixel-perfect and responsive
- Tailwind-only: no global CSS (except for tokens/utilities)
- Use `clsx()` for conditional styling
- Transitions should feel native, subtle, fast
- Claude must ask: "Would you like animation or hover effects?" for new components
- Use accessible HTML + ARIA when relevant
- Claude must confirm component usage patterns before generating new ones
- Use SVGs for icons where possible (avoid external icon fonts)

---

## ğŸ’» TECH STACK RULES

### TypeScript
- No `any` or `unknown` types â€“ infer or constrain types
- Use discriminated unions for state machines
- No default exports â€“ always use named exports
- Component props must be explicitly typed

### Vite
- Fast builds expected â€“ no heavy polyfills
- Code splitting encouraged if modules grow large

### Tailwind
- Never duplicate class strings â€“ extract into `className` helpers if reused
- Avoid arbitrary values unless necessary (e.g., `[40px]`)
- Use design tokens (`theme('colors.primary')`) where possible

### Netlify Functions
- Use TypeScript + named handlers
- Every function should be testable (pure logic extracted)
- Use `netlify/functions/utils.ts` for common server logic
- Claude may generate serverless functions only in this directory

### Supabase
- Never hardcode secrets â€“ use `process.env`
- All DB writes must be authenticated
- No raw SQL unless inside Supabase Edge Functions
- Claude must ask: â€œIs this a client-side or backend DB call?â€ before querying

---

## ğŸ§  CLAUDE BEHAVIOR

### Claude Must:
- Ask before creating files or directories
- Use @file references when accessing specific code
- Label all major tasks with headers (e.g., `## Plan`, `## Implementation`, `## Refactor`)
- Summarize what itâ€™s doing before modifying code
- Never leave placeholders or partial implementations
- Never edit files without showing a plan and asking approval

### Never Do:
- Never duplicate old + new code â€“ delete whatâ€™s replaced
- Never use `any` or `interface {}` types
- Never keep unused code or comments (use git if needed)
- Never modify formatting manually â€“ run formatter
- Never name files with `v2`, `new`, `copy`, etc.

---

## ğŸ§ª TESTING STRATEGY

### When:
- âœ… Complex logic â†’ tests first
- âœ… CRUD logic â†’ tests after
- âœ… High-traffic path â†’ include benchmarks

### Standards:
- Unit tests must be deterministic
- Use `describe()` and `it()` for structure
- Prefer `vitest` with `@testing-library/react` for UI
- No `console.log` in tests â€“ use assertions
- Table-driven tests encouraged for business logic
- Use `mockServiceWorker` or Supabase stubs for integration

---

## ğŸ” CLAUDE SUBAGENTS

When tasks are large or multi-layered, Claude must say:  
> â€œI'll spawn agents to tackle different aspects of this problem.â€

### Examples:
- One agent reads the DB schema, another scans the API routes
- One agent implements a component, another writes tests
- One agent refactors old logic, another benchmarks performance

Claude must report outputs clearly:
- Prefix each result: `ğŸ” DB Agent:`, `ğŸ§ª Test Agent:`, `ğŸ”§ Refactor Agent:`

Subagents may not modify code unless authorized.

---

## ğŸ“‘ TASK TRACKING

Maintain a `TODO.md` file with clear sections:

```md
## Current Task
- [ ] Add avatar upload to user profiles

## Completed
- [x] Refactored profile view
- [x] Added file input to UI
- [x] Connected Supabase storage

## Next Steps
- [ ] Add loading state
- [ ] Improve mobile layout
```

Claude must pause at each milestone and ask:  
> â€œWould you like to update TODO.md or continue?â€

---

## ğŸ§  CONTEXT STABILITY

If Claude loses memory or context seems stale:
- Re-read this CLAUDE.md
- Ask for summary from `PROGRESS.md`
- Validate: â€œWhat have we done so far? Whatâ€™s next?â€

---

## ğŸ”’ SECURITY & PERFORMANCE

- Always validate user inputs (client and backend)
- Use `crypto.getRandomValues()` (not `Math.random`)
- Use `prepared` Supabase queries or edge functions
- Never expose secrets or tokens in client code
- For perf: benchmark before optimizing
- Use `requestIdleCallback`, lazy imports, and Suspense for UI perf

---

## ğŸ’¬ CLAUDE COMMUNICATION

### Always Communicate:
- â€œHereâ€™s what I plan to do. Approve?â€
- â€œDone implementing. All tests passing.â€
- â€œFound a better pattern. Want to apply it?â€

### Ask Before:
- Creating or renaming files
- Adding libraries
- Changing existing data models

---

## ğŸ’£ FAILURE HANDLING

When hooks fail:

1. âŒ STOP â€“ do not continue
2. âœ… Run: `make fmt && make lint && make test`
3. ğŸ›  Fix all errors
4. âœ… Verify fixes
5. ğŸ§­ Resume original task

---

## ğŸ§± ARCHITECTURE RULES

- Clear > Clever
- Compose logic > Inherit
- Favor composition over abstraction
- Reuse components over rewriting
- No shared â€œutilsâ€ bloat â€“ colocate helpers
- All exported types/functions must have JSDoc

---

## ğŸš€ PRODUCTION-QUALITY CODE =

âœ… Feature works  
âœ… All tests pass  
âœ… All linters pass  
âœ… Old code removed  
âœ… Beautiful UI/UX  
âœ… CLAUDE.md followed

---

REMINDER:  
If this file hasnâ€™t been referenced in 30+ minutes, re-read it before continuing.
